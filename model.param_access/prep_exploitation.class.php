<?php
include_once('../model.param_access/param_connexion.php');
class prep_exploitation{
    private static  $idExploitation;
    private static  $idLecon;
    private static  $idDiscipline;
    private static  $code;
    private static  $date;
    private static  $reference;
    private static  $competence;
    private static  $mtdidact;
    private static  $exempleSituation;
    private static  $critere_evaluation;
    private static  $dateCreation;
    private static $con;
    //CONSTRUCTEUR
    public function __construct(){
        return self::$con=con();
    }
    //METHODES
    public static function ajouter($idLecon, $idDiscip, $cd, $dt,$ref,$competence, $mtdidact,$exempleSt,$critere)
    {
        $idLc=htmlspecialchars($idLecon);
        $idDiscipline=htmlspecialchars($idDiscip);
        $code=htmlspecialchars($cd);
        $date=htmlspecialchars($dt);       
        $reference=htmlspecialchars($ref);
        $competence=htmlspecialchars($competence);
        $mtdidact=htmlspecialchars($mtdidact);
        $exempleSituation=htmlspecialchars($exempleSt);
        $critere_eva=htmlspecialchars($critere);
                  $req=self::$con->prepare('INSERT INTO prep_exploitation(idLecon,idDiscipline,code,dateExp,reference,competence,materielDidact,exempleSituation,critere_evaluation) VALUES (?,?,?,?,?,?,?,?,?)');
                    if($req->execute(array($idLc,$idDiscipline,$code, $date, $reference,$competence, $mtdidact, $exempleSituation,$critere_eva))){
                        $exp  = new prep_exploitation();   
                        $exp = $exp->filtrerDesc($idLc)->fetch();
                        return $exp['idExploitation'];          
                    }else{
                        return 0;
                    }  
    }
    public static function modifier($idExp,$idLecon, $idDiscip, $cd, $dt,$ref,$competence, $mtdidact,$exempleSt,$critere){
         $idExp=htmlspecialchars($idExp);
        $idLecon =htmlspecialchars($idLecon);
        $idDiscip =htmlspecialchars($idDiscip);
        $cd =htmlspecialchars($cd);
        $dt =htmlspecialchars($dt);
        $ref =htmlspecialchars($ref);
        $competence =htmlspecialchars($competence);
        $mtdidact =htmlspecialchars($mtdidact);
        $exempleSt =htmlspecialchars($exempleSt);
        $critere_eva=htmlspecialchars($critere);
        return $req=self::$con->query('UPDATE prep_exploitation SET idDiscipline ="'.$idDiscip.'",code  ="'.$cd.'", dateExp ="'.$dt.'",reference ="'.$ref.'", materielDidact ="'.$mtdidact.'", competence ="'.$competence.'", exempleSituation ="'.$exempleSt.'", idLecon ="'.$idLecon.'", critere_evaluation="'.$critere_eva.'" WHERE idExploitation="'.$idExp.'"');

    }
     public static function selectionner(){
        return $req=self::$con->query('SELECT * FROM prep_exploitation as exp INNER JOIN prep_discipline as disc ON exp.idDiscipline=disc.idDiscipline INNER JOIN prep_sous_domaine as domain ON disc.idSousDomaine=domain.idSousDomaine');
    }
    public static function filtrer($idLc){
        return $req=self::$con->query('SELECT * FROM prep_exploitation as exp INNER JOIN prep_discipline as disc ON exp.idDiscipline=disc.idDiscipline INNER JOIN prep_sous_domaine as domain ON disc.idSousDomaine=domain.idSousDomaine WHERE exp.idLecon='.$idLc );
    }
   public static function filtrerDesc($idLc){
        return $req=self::$con->query('SELECT * FROM prep_exploitation as exp INNER JOIN prep_discipline as disc ON exp.idDiscipline=disc.idDiscipline INNER JOIN prep_sous_domaine as domain ON disc.idSousDomaine=domain.idSousDomaine WHERE exp.idLecon='.$idLc.' ORDER BY exp.idExploitation DESC');
    }
   
    //DESTRUCTEUR
    public function __destuct(){
    }
}

